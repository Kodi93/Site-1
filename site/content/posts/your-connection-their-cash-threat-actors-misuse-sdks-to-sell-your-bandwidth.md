+++
title = "Your Connection, Their Cash: Threat Actors Misuse SDKs to Sell Your Bandwidth"
date = "2025-09-11T13:17:48.389338Z"
tags = ["security", "certification"]
description = "<p>A campaign leverages CVE-2024-36401 to stealthily monetize victims' bandwidth where legitimate software development kits (SDKs) are deployed for pa"
canonicalURL = "https://unit42.paloaltonetworks.com/attackers-sell-your-bandwidth-using-sdks/"
+++

Your Connection, Their Cash: Threat Actors Misuse SDKs to Sell Your Bandwidth — summary and exam-relevant notes.

## Key Points
- Key insight 1
- Key insight 2
- Key insight 3

## Details
We have detected a campaign aimed at gaining access to victims’ machines and monetizing access to their bandwidth. It functions by exploiting the CVE-2024-36401 vulnerability in the GeoServer geospatial database. This Critical-severity remote code execution vulnerability has a CVSS score of 9.8. Criminals have used the vulnerability to deploy legitimate software development kits (SDKs) or modified apps to gain passive income via network sharing or residential proxies. This method of generating passive income is particularly stealthy. It mimics a monetization strategy used by some legitimate app developers who choose SDKs instead of displaying traditional ads. This can be a well-intentioned choice that protects the user experience and improves app retention. The applications we found in this malicious activity are nearly silent when operating. They consume minimal resources while monetizing victims' internet bandwidth, and without creating or distributing malware. This integration allows app developers to receive payments, while criminals profit from unused server resources, minimizing their risk of detection. Since March 2025, attackers have been probing GeoServer instances exposed to the internet. Cortex Xpanse reported 3,706 publicly accessible GeoServers in the first week of May 2025, indicating a potentially large attack surface for adversaries targeting CVE-2024-36401. Palo Alto Networks customers are better protected from the threats described through the following products and services: If you think you might have been compromised or have an urgent matter, contact the Unit 42 Incident Response team . We have closely monitored a campaign that first emerged in early March 2025. The attackers have shifted infrastructure as well as tactics, techniques and procedures (TTPs) to maintain persistence. We detected that attackers misused an SDK and an app during their campaign: The following timeline reveals how this threat has evolved. The campaign began with exploit attempts targeting CVE-2024-36401, then delivered the misused app and the misused SDK payloads. Attackers shifted tactics during this phase of the campaign. Attackers expanded their infrastructure during this phase of the campaign. As of this writing, exploit attempts continue from 185.246.84[.]189 , and the customized executable distribution hosts remain online. The core of this vulnerability lies in an attacker's ability to inject arbitrary code into JXPath query statements. JXPath is a library within the Apache Commons project that offers an XPath implementation. XPath is a widely adopted standard for querying and transforming XML documents. JXPath transparently extends the use of XPath expressions to various Java data structures beyond XML, including JavaBeans and multiple collections. From a security standpoint, this additional flexibility also introduces significant concerns. JXPath supports extension functionality , which an attacker can exploit if they gain control over the query statement, allowing them to execute arbitrary code. This poses a greater risk than typical query injection vulnerabilities. For instance, attackers have used Standard Extension Functions to invoke methods like getRuntime().exec() . Figure 1 shows an example of malicious code that leverages JXPath's ability to evaluate expressions, allowing an attacker to inject and execute arbitrary system commands via the #{cmd} placeholder. By referencing exec(java.lang.Runtime.getRuntime() within context.getValue , an attacker triggers Java's runtime execution mechanism, leading to remote code execution on the target system. Figure 2 reveals the payload from this attack. We redacted the key part of the payload in Figure 2. The redacted portion forces the victim to execute a system command to download a file from the attacker's host distribution IP addresses. According to the NVD : This vulnerability has been confirmed to be exploitable through various Web Feature Service (WFS), Web Map Service (WMS), and Web Processing Service (WPS) requests, including GetFeature, GetPropertyValue, GetMap, GetFeatureInfo, GetLegendGraphic, and Execute requests. While analyzing an exploit used in this attack, we set up a GeoServer instance and used an in-the-wild exploit payload to analyze how the exploit works. We can see what is happening inside GeoServer by following its code flow. After we simulated sending an attack payload, our command was passed to the function GetPropertyValue . As shown at the bottom of Figure 3, the highlighted line takes the incoming request object and passes it to a run method. The command is carried by request.valueReference . Stepping into this function reveals that the payload from Figure 2 was passed to the object propertyNameNoIndexes , shown from the exploit code in Figure 4. Later, this object invokes the Geotools method evaluate . Note that we have entered the GeoTools codebase. The evaluate method retrieves the value of the Geotools attribute from the given object. Within this method, a PropertyAccessor object is used to read the property. Figure 5 shows that PropertyAccessor is a core interface that defines operations for reading and writing property values of an object. GeoTools will attempt to find an accessor based on the provided parameters. Once an accessor has been successfully found, it will use the object's get method to retrieve the property value. Figure 6 shows that our payload has been passed into that method via the parameter attPath . The object's get method invokes the JXPath library function iteratePointers . As shown in Figure 7, a payload is injected into the xpath variable, which is then passed to the context.iteratePointers method. The ExtensionFunction has been manipulated and uses computeValue to evaluate the expression. As shown in Figure 8, the function variable now points directly to javax.lang.Runtime.exec , which is Java's standard method for running operating system commands. The parameters to be passed to this function include the attacker's command, and the highlighted line executes the command. Cortex Xpanse telemetry data from March and April 2025 revealed 7,126 publicly exposed GeoServer instances across 99 countries. The five countries where these instances are hosted the most are shown in Figure 9. The majority of the exposed servers are hosted in China. We have captured multiple distinct exploit strategies from this campaign. All strategies aim to deploy and run an SDK on the victim system.



{{< aff "training_partner" "Recommended course" >}}

{{< aff "vpn_vendor" "Try a VPN deal" >}}

*Updated: 2025-09-11*